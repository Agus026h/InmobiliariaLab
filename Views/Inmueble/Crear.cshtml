@using Microsoft.AspNetCore.Mvc.TagHelpers
@model devs.Models.Inmueble

@{
    ViewData["Title"] = "Crear";
    var listaPropietarios = (IList<Propietario>)ViewBag.Propietarios;
}

<h4>Nuevo Inmueble</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        
     
        <form asp-action = "Crear" method="post">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            
           

            <div class="form-group">
                <label asp-for="Direccion" class="control-label"></label>
                <input asp-for="Direccion" class="form-control" />
                <span asp-validation-for="Direccion" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Uso" class="control-label"></label>
                <select asp-for="Uso" asp-items="Html.GetEnumSelectList<devs.Models.UsoInmueble>()" class="form-select"></select>
                <span asp-validation-for="Uso" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Ambientes" class="control-label"></label>
                <input asp-for="Ambientes" class="form-control" />
                <span asp-validation-for="Ambientes" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Precio" class="control-label"></label>
                <input asp-for="Precio" class="form-control" />
                <span asp-validation-for="Precio" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Latitud" class="control-label"></label>
                <input asp-for="Latitud" class="form-control" />
                <span asp-validation-for="Latitud" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Longitud" class="control-label"></label>
                <input asp-for="Longitud" class="form-control" />
                <span asp-validation-for="Longitud" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Estado" class="control-label"></label>
                <select asp-for="Estado" asp-items="Html.GetEnumSelectList<devs.Models.EstadoInmueble>()" class="form-select"></select>
                <span asp-validation-for="Estado" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Tipo" class="control-label"></label>
                <select asp-for="Tipo" asp-items="Html.GetEnumSelectList<devs.Models.TipoInmueble>()" class="form-select"></select>
                <span asp-validation-for="Tipo" class="text-danger"></span>
            </div>


             <div class="form-group">
				<label class="control-label">Propietario</label>
				<select id="Propietario" class="form-control" name="IdPropietario">
					
				</select>
			</div>
            @* <div class="form-group">
				<label asp-for=IdPropietario class="control-label ">Propietario</label>
				<select class="form-control form-select" name="IdPropietario">
					@foreach (var item in listaPropietarios)
					{
						<option value="@item.IdPropietario">@(item.ToString())</option>
					}
				</select>
				<span asp-validation-for="IdPropietario" class="text-danger"></span>
			</div> *@
            <div class="form-group">
                <button type="submit"  class="btn btn-primary ">Crear</button>
                
            </div>
        </form>
    </div>
</div>
@if (ViewBag.Mensaje != null)
{
    <div class="alert alert-info">
        @ViewBag.Mensaje
    </div>
}

@section Scripts{
        <script type ="text/javascript">
          $(document).ready(function() {
          

          $('#Propietario').select2({
            language : "es",
            theme: 'bootstrap',
            placeholder: "Buscar propietario..",
            minimumInputLength: 2,
            maximumInputLength: 10,
            ajax: {
                delay: 250,
                dataType: "json",
                cache: true,
                url: function(params){
                    let q = params.term ? encodeURIComponent(params.term) : ""
                    return  `/Propietario/Buscar/${q}`;
                },
                processResults: function (res){
                    return{
                        results: res.datos.map(p => ({id: p.idPropietario, text: `${p.nombre} ${p.apellido}` }))
                    };
                }
            }
          });

          });

        </script>


}


